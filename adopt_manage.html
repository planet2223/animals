<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é ˜é¤ŠåˆŠç™»ç®¡ç†</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/myall.css">
    <link rel="stylesheet" href="css/color.css">
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


    <style>
        .s02-text {
            background-color: rgba(235, 214, 243, 0.2);
            padding: 5px;
        }

        .navbar-nav .nav-link {
            color: black;
            /* ä¿®æ”¹ç‚ºä½ æƒ³è¦çš„é¡è‰² */
            padding: 10px 10px;
        }

        .navbar-nav .nav-link:hover {
            background-color: rgba(170, 122, 49, 0.534);
            /* ç•¶æ»‘é¼ æ‡¸åœæ™‚çš„é¡è‰² */
            color: aliceblue;
        }

        @media screen and (max-width: 768px) {}

        body {
            font-family: "Zen Maru Gothic", serif;
        }

        #s01 i {
            color: var(--mycolor11);
        }

        .dropdown-menu {
            background-color: #f5f5f5;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px;
            width: 200px;
        }

        .dropdown-item:hover {
            color: #d95372;
            /* æ·¡æ£•è‰²ä½œç‚ºé«˜äº®é¡è‰² */
        }

        #admin_control_nav,
        #public_adoption_nav {
            font-size: 16px;
            margin: 5px 0;
            padding: 6px;
            padding-left: 20px;
            /* å‘å³ç§»å‹• */
        }

        #s02_username_showtext {
            color: var(--mycolor11);
            margin-bottom: 20px;
            /* èª¿æ•´å‘ä¸‹è·é›¢ */
        }

        #s03 {
            border-bottom: 3px solid #633939;
            /* åœ¨åº•éƒ¨åŠ ä¸€æ¢ç·š */
            border-top: 3px solid #633939;
            border-left: 3px solid #633939;
            border-right: 3px solid #633939;
            padding-bottom: 20px;
            /* è®“å®ƒèˆ‡å…§å®¹æœ‰é»è·é›¢ */
            padding-top: 20px;
            /* èª¿æ•´æ•¸å€¼ä¾†å¢åŠ ä¸Šæ–¹ç©ºé–“ */
        }


        /* âœ… è®“è¡¨æ ¼å…§å®¹æ›´æ¸…æ™° */
        .table th,
        .table td {
            vertical-align: middle;
            text-align: center;
        }

        /* âœ… è®“æè¿°æ¬„ä½ä¸æœƒå¤ªé•· */
        .table td:nth-child(6) {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* âœ… è®“åœ–ç‰‡å¤§å°çµ±ä¸€ */
        .pet-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 5px;
        }

        /* âœ… è®“åˆªé™¤æŒ‰éˆ•æ›´çªå‡º */
        .delete-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        /* è¡¨å–® */
        .delete-btn:hover {
            background-color: #fdc6cb;
        }

        .img-preview {
            max-width: 100%;
            height: auto;
            max-height: 200px;
            /* é™åˆ¶åœ–ç‰‡é è¦½é«˜åº¦ */
            border-radius: 8px;
            display: block;
            margin: 0 auto;
        }

        .btn-cute {
            background-color: #fae4b6;
            color: black;
            font-size: 20px;
            font-weight: bold;
            border-radius: 25px;
            transition: 0.3s;
        }

        .btn-cute:hover {
            background-color: #e0daaf;
        }

        .form-label {
            font-size: 20px;
        }

        .card {
            max-width: 650px;
            /* é™åˆ¶æ¡†æ¶æœ€å¤§å¯¬åº¦ */
            margin: auto;
            /* ç½®ä¸­ */
            border-radius: 12px;
        }
    </style>

</head>

<body class=>
    <!-- section 01 -->
    <section id="s01" style="background-color:#FFFAF2;" class="py-1">
        <div class="container">
            <div class="text-end">
                <a href="#"><i class="fa-brands fa-facebook-f pe-1 tx-03"></i></a>
                <a href="#"><i class="fa-brands fa-x-twitter pe-1 tx-03"></i></a>
                <a href="#"><i class="fa-brands fa-threads pe-1 tx-03"></i></a>
                <a href="#"><i class="fa-brands fa-line pe-1 tx-03"></i></a>
                <a href="#"><i class="fa-brands fa-instagram pe-1 tx-03"></i></a>
            </div>
        </div>
    </section>

    <section id="s02" class="bg-001">
        <div class="container">
            <nav class="navbar navbar-expand-lg bg-001 navbar-dark">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">
                        <i class="fa fa-paw fa-regular fa-4x" style="color: #8b6f4f;"></i>
                    </a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav me-auto mb-2 mb-lg-0">

                            <li class="nav-item dropdown bg-002 ms-5 fw-500">
                                <a class="nav-link" href="animals.html">
                                    <i class="fa-regular fa-heart nav-icon " aria-hidden="true"></i>
                                    <span>é¦–é </span>
                                </a>
                            </li>

                            <li class="nav-item dropdown bg-002 ms-5 fw-500">
                                <a class="nav-link" href="animal_data.html">
                                    <i class="fa-regular fa-heart nav-icon" aria-hidden="true"></i>
                                    <span>å…¬ç«‹é ˜é¤Š</span>
                                </a>
                            </li>

                            <li class="nav-item dropdown bg-002 ms-5 fw-500">
                                <a class="nav-link" href="adopt_list.html">
                                    <i class="fa-regular fa-heart nav-icon" aria-hidden="true"></i>
                                    <span>é ˜é¤Šèªé¤Š</span>
                                </a>
                            </li>

                            <li id="public_adoption_nav" class="d-none">
                                <a class="dropdown-item" href="adopt_manage.html">é ˜é¤ŠåˆŠç™»ç®¡ç†</a>
                            </li>
                            <li id="admin_control_nav" class="d-none">
                                <a class="dropdown-item" href="admin_control.html">å¾Œå°æ§åˆ¶</a>
                            </li>
                        </ul>
                        <div>

                            <!-- å¥—ç”¨ CSS è®Šæ•¸ --mycolor01 -->
                            <span class="h5 fw-900 me-3 mt-5 d-none" id="s02_username_showtext"
                                style="color: var(--mycolor11);">
                                <i class="fa-solid fa-user fa-xs"></i>
                                <span class="h5" id="s02_username_text">XXX</span>
                            </span>
                            <button class="btn" data-bs-toggle="modal" data-bs-target="#registerModal"
                                id="s02_reg_btn">|
                                Register |</button>
                            <button class="btn" data-bs-toggle="modal" data-bs-target="#loginModal" id="s02_login_btn">|
                                Login |</button>
                            <button class="btn d-none" id="s02_logout_btn">| ç™»å‡º |</button>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </section>


    <!-- registerModal -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-l">
            <div class="modal-content">
                <div class="modal-header bg-005" style="color: black;">
                    <h1 class="modal-title fs-4 fw-900" id="exampleModalLabel">é ˜é¤Šäººè¨»å†Š</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-11">
                            <div class="mb-3">
                                <label for="username_reg" class="form-label">å¸³è™Ÿ</label>
                                <input type="text" class="form-control is-invalid" id="username_reg" name="username_reg"
                                    placeholder="3-6å­—æ•¸">
                                <div class="valid-feedback" id="regModal_username_valid_feedback">ç¬¦åˆè¦å‰‡</div>
                                <div class="invalid-feedback" id="regModal_username_invalid_feedback">ä¸ç¬¦åˆè¦å‰‡</div>
                            </div>
                            <div class="mb-3">
                                <label for="password_reg" class="form-label">å¯†ç¢¼</label>
                                <input type="password" class="form-control is-invalid" id="password_reg"
                                    name="password_reg" placeholder="3-6å­—æ•¸">
                                <div class="valid-feedback">ç¬¦åˆè¦å‰‡</div>
                                <div class="invalid-feedback">ä¸ç¬¦åˆè¦å‰‡</div>
                            </div>
                            <div class="mb-3">
                                <label for="re_password_reg" class="form-label">ç¢ºèªå¯†ç¢¼</label>
                                <input type="password" class="form-control is-invalid" id="re_password_reg"
                                    name="re_password_reg">
                                <div class="valid-feedback">ç¬¦åˆè¦å‰‡</div>
                                <div class="invalid-feedback">ä¸ç¬¦åˆè¦å‰‡</div>
                            </div>
                            <div class="mb-3">
                                <label for="email_reg" class="form-label">Email</label>
                                <input type="email" class="form-control is-invalid" placeholder="3-10å­—æ•¸" id="email_reg"
                                    name="email_reg">
                                <div class="valid-feedback">ç¬¦åˆè¦å‰‡</div>
                                <div class="invalid-feedback">ä¸ç¬¦åˆè¦å‰‡</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" style="background-color: #f0e0da;"
                        data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn bg-005" id="ok_btn_reg">ç¢ºèª</button>
                </div>
            </div>
        </div>
    </div>

    <!-- loginModal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-005">
                    <h1 class="modal-title  fs-4 fw-900" id="exampleModalLabel">é ˜é¤Šäººç™»å…¥</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="username_login" class="form-label">å¸³è™Ÿ</label>
                        <input type="text" class="form-control is-invalid" id="username_login" name="username_login">
                        <div class="invalid-feedback">è«‹è¼¸å…¥å¸³è™Ÿ</div>
                    </div>
                    <div class="mb-3">
                        <label for="password_login" class="form-label">å¯†ç¢¼</label>
                        <input type="password" class="form-control is-invalid" id="password_login"
                            name="password_login">
                        <div class="invalid-feedback">è«‹è¼¸å…¥å¯†ç¢¼</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" style="background-color: #f0e0da;"
                        data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn bg-005" id="ok_btn_login">ç¢ºèª</button>
                </div>
            </div>
        </div>
    </div>


    <form id="adoptForm" class="mx-auto row justify-content-center bg-001 ">
        <div class="container mt-5 ">
            <div class="card shadow-lg border-0 rounded-4 ">
                <div class="card-header text-center bg-light">
                    <h4 class="my-2"> é ˜é¤Šå¯µç‰©åˆŠç™» </h4>
                </div>
                <div class="card-body">
                    <form id="adoptForm" class="mx-auto row justify-content-center">
                        <div class="col-md-10  mx-auto">
                            <div class="mb-3">
                                <label for="pet_name" class="form-label">ğŸ¶ å¯µç‰©åç¨±</label>
                                <input type="text" class="form-control form-control-sm" id="pet_name" name="pet_name"
                                    required>
                            </div>

                            <div class="mb-3">
                                <label for="species" class="form-label">ğŸ“‹ å“ç¨®</label>
                                <input type="text" class="form-control form-control-sm" id="species" name="species"
                                    required>
                            </div>

                            <div class="mb-3">
                                <label for="age" class="form-label">ğŸ‚ å¹´é½¡</label>
                                <input type="number" class="form-control form-control-sm" id="age" name="age" required>
                            </div>

                            <div class="mb-3">
                                <label for="gender" class="form-label">âš¥ æ€§åˆ¥</label>
                                <select class="form-select form-control-sm" id="gender" name="gender" required>
                                    <option value="å…¬">å…¬</option>
                                    <option value="æ¯">æ¯</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="location" class="form-label">ğŸ“ æ‰€åœ¨ç¸£å¸‚</label>
                                <select class="form-select form-control-sm" id="location" name="location" required>
                                    <option value="" selected disabled>è«‹é¸æ“‡ç¸£å¸‚</option>
                                    <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
                                    <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
                                    <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
                                    <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
                                    <option value="å°å—å¸‚">å°å—å¸‚</option>
                                    <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
                                    <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
                                    <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
                                    <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
                                    <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
                                    <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
                                    <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
                                    <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
                                    <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
                                    <option value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</option>
                                    <option value="å±æ±ç¸£">å±æ±ç¸£</option>
                                    <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
                                    <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
                                    <option value="å°æ±ç¸£">å°æ±ç¸£</option>
                                    <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
                                    <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
                                    <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="description" class="form-label">ğŸ“ å¯µç‰©è³‡è¨Šæè¿°</label>
                                <h6 class="" style="color: var(--mycolor02)">
                                    å»ºè­°æä¾›æ›´å¤šè©³ç´°çš„è¨Šæ¯ï¼Œä¾‹å¦‚ç–«è‹—æ–½æ‰“ç‹€æ³ï¼Œæ˜¯å¦çµ•è‚²ï¼Œèº«é«”æœ‰ç„¡ç–¾ç—…ï¼Œå€‹æ€§ç­‰ç­‰ï¼Œä»¥æé«˜è¢«é ˜é¤Šçš„æ©Ÿæœƒå–”!</h6>
                                <textarea class="form-control form-control-sm" id="description" name="description"
                                    rows="3" placeholder="è«‹è¼¸å…¥è©³ç´°çš„æè¿°"></textarea>
                            </div>

                            <!-- âœ… åœ–ç‰‡ä¸Šå‚³ -->
                            <div class="mb-3">
                                <label for="animal_image" class="form-label">ğŸ“· ä¸Šå‚³åœ–ç‰‡</label>
                                <input type="file" id="animal_image" name="animal_image"
                                    class="form-control form-control-sm" accept="image/*">
                            </div>

                            <!-- âœ… åœ–ç‰‡å³æ™‚é è¦½ -->
                            <div class="mb-3 text-center">
                                <img id="previewImage" src="/web202411/imgs/ani19.jpg" alt="åœ–ç‰‡é è¦½"
                                    class="img-preview rounded shadow">
                            </div>

                            <div class="text-center">
                                <button type="submit" class="btn btn-cute px-4 py-2"> æ–°å¢åˆŠç™» </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </form>

    <hr class="my-5">

    <!-- å·²åˆŠç™»è³‡æ–™åˆ—è¡¨ -->
    <h2 class="mb-4 text-center">ğŸ“‹ å·²åˆŠç™»çš„å¯µç‰©</h2>

    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-dark text-center">
                <tr>
                    <th>åå­—</th>
                    <th>å“ç¨®</th>
                    <th>å¹´é½¡</th>
                    <th>æ€§åˆ¥</th>
                    <th>æ‰€åœ¨åœ°</th>
                    <th>æè¿°</th>
                    <th>åœ–ç‰‡</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody id="adoptList">
                <!-- JS ç”ŸæˆåˆŠç™»è³‡æ–™ -->
            </tbody>
        </table>
    </div>

    <!-- ğŸ“ ç·¨è¼¯å¯µç‰© Modal -->
    <div class="modal fade" id="editAnimalModal" tabindex="-1" aria-labelledby="editAnimalModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editAnimalModalLabel">ä¿®æ”¹å¯µç‰©è³‡æ–™</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editAnimalForm">
                        <input type="hidden" id="editAnimalId">
                        <div class="mb-3">
                            <label for="edit_pet_name" class="form-label">ğŸ¶ å¯µç‰©åç¨±</label>
                            <input type="text" class="form-control" id="edit_pet_name" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_species" class="form-label">ğŸ“‹ å“ç¨®</label>
                            <input type="text" class="form-control" id="edit_species" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_age" class="form-label">ğŸ‚ å¹´é½¡</label>
                            <input type="number" class="form-control" id="edit_age" required>
                        </div>
                        <div class="mb-3">
                            <label for="edit_gender" class="form-label">âš¥ æ€§åˆ¥</label>
                            <select class="form-select" id="edit_gender" required>
                                <option value="å…¬">å…¬</option>
                                <option value="æ¯">æ¯</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit_location" class="form-label">ğŸ“ æ‰€åœ¨ç¸£å¸‚</label>
                            <select class="form-select" id="edit_location" required>
                                <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
                                <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
                                <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
                                <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
                                <option value="å°å—å¸‚">å°å—å¸‚</option>
                                <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
                                <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
                                <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
                                <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
                                <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
                                <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
                                <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
                                <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
                                <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
                                <option value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</option>
                                <option value="å±æ±ç¸£">å±æ±ç¸£</option>
                                <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
                                <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
                                <option value="å°æ±ç¸£">å°æ±ç¸£</option>
                                <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
                                <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
                                <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="edit_description" class="form-label">ğŸ“ ç°¡å–®æè¿°
                            </label>

                            <textarea class="form-control" id="edit_description" rows="3"></textarea>
                        </div>
                        <div class="mb-3 text-center">
                            <button type="submit" class="btn btn-success">å„²å­˜ä¿®æ”¹</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>



    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/counterup2@2.0.2/dist/index.js"></script>
    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>

        // å³æ™‚ç›£è½username_reg
        $("#username_reg").bind("input propertychange", function () {
            if ($(this).val().length > 2 && $(this).val().length < 7) {
                var JSONdata = { username: $("#username_reg").val() };
                $.ajax({
                    type: "POST",
                    url: "ani_member_control_api_v1.php?action=checkuni",
                    data: JSON.stringify(JSONdata),
                    dataType: "json",
                    success: showdata_checkuni,
                    error: function () {
                        Swal.fire({
                            title: "APIä»‹æ¥éŒ¯èª¤?",
                            text: "ani_member_control_api_v1.php?action=checkuni",
                            icon: "error"
                        });
                    }
                });
            } else {
                $(this).removeClass("is-valid").addClass("is-invalid");
                $("#regModal_username_invalid_feedback").text("å¸³è™Ÿé•·åº¦éœ€ä»‹æ–¼ 3-6 å­—å…ƒï¼");
                flag_username_reg = false;
            }
        });

        // å³æ™‚ç›£è½å¯†ç¢¼è¼¸å…¥æ¡†
        $("#password_reg").on("input", function () {
            let password = $(this).val();
            if (password.length >= 2) { // åªè¦2å€‹å­—ä»¥ä¸Š
                $(this).removeClass("is-invalid").addClass("is-valid");
            } else {
                $(this).removeClass("is-valid").addClass("is-invalid");
            }
        });

        // å³æ™‚ç›£è½ç¢ºèªå¯†ç¢¼è¼¸å…¥æ¡†
        $("#re_password_reg").on("input", function () {
            let password = $("#password_reg").val();
            let rePassword = $(this).val();
            if (rePassword === password && rePassword.length >= 2) { // å¯†ç¢¼ä¸€è‡´ä¸”2å­—ä»¥ä¸Š
                $(this).removeClass("is-invalid").addClass("is-valid");
            } else {
                $(this).removeClass("is-valid").addClass("is-invalid");
            }
        });

        // å³æ™‚ç›£è½Emailè¼¸å…¥æ¡†
        $("#email_reg").on("input", function () {
            let email = $(this).val();
            if (email.length >= 2) { // åªè¦2å€‹å­—ä»¥ä¸Š
                $(this).removeClass("is-invalid").addClass("is-valid");
            } else {
                $(this).removeClass("is-valid").addClass("is-invalid");
            }
        });

        $("#ok_btn_reg").on("click", function () {
            let username = $("#username_reg").val();
            let password = $("#password_reg").val();
            let rePassword = $("#re_password_reg").val();
            let email = $("#email_reg").val();

            if (!username || !password || !rePassword || !email) {
                Swal.fire("è«‹å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½ï¼");
                return;
            }

            if (password !== rePassword) {
                Swal.fire("å¯†ç¢¼èˆ‡ç¢ºèªå¯†ç¢¼ä¸ä¸€è‡´ï¼");
                return;
            }

            let JSONdata = { username, password, email };

            $.ajax({
                type: "POST",
                url: "ani_member_control_api_v1.php?action=register",
                data: JSON.stringify(JSONdata),
                dataType: "json",
                success: function (response) {
                    if (response.state) {
                        Swal.fire({
                            title: "è¨»å†ŠæˆåŠŸï¼",
                            text: "æ­¡è¿ " + response.data.Username,
                            icon: "success"
                        }).then(() => {
                            $("#registerModal").modal("hide");
                            location.reload(); // é‡æ–°æ•´ç†é é¢
                        });
                    } else {
                        Swal.fire({
                            title: "è¨»å†Šå¤±æ•—",
                            text: response.message,
                            icon: "error"
                        });
                    }
                },
                error: function () {
                    Swal.fire("API éŒ¯èª¤", "ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨", "error");
                }
            });
        });

        // ok_btn_login æŒ‰éˆ•ç›£è½
        $("#ok_btn_login").on("click", function () {
            var loginData = {
                username: $("#username_login").val(),
                password: $("#password_login").val()
            };

            $.ajax({
                type: "POST",
                url: "ani_member_control_api_v1.php?action=login",
                data: JSON.stringify(loginData),
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    console.log("âœ… ç™»å…¥ API å›æ‡‰ï¼š", response);
                    if (response.state) {
                        Swal.fire({
                            title: "ç™»å…¥æˆåŠŸï¼",
                            text: "æ­¡è¿å›ä¾†ï¼Œ" + response.data.Username,
                            icon: "success"
                        }).then(() => {
                            setCookie("Uid01", response.data.Uid01, 7);
                            updateUI(true, response.data.Username);
                            $("#loginModal").modal("hide");

                            // âœ… ç«‹å³è¼‰å…¥å·²åˆŠç™»çš„å¯µç‰©è³‡æ–™ï¼ˆæ–°å¢é€™ä¸€è¡Œï¼‰
                            loadAnimalList();
                        });
                    } else {
                        Swal.fire({
                            title: "ç™»å…¥å¤±æ•—",
                            text: response.message,
                            icon: "error"
                        });
                    }
                },
                error: function (xhr) {
                    Swal.fire({
                        title: "éŒ¯èª¤",
                        text: "ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨ã€‚",
                        icon: "error"
                    });
                }
            });
        });


        // ç™»å‡ºæŒ‰éˆ•ç›£è½
        $("#s02_logout_btn").click(function () {
            var JSONdata = JSON.stringify({ uid01: getCookie("Uid01") });
            console.log("ç™¼é€è‡³å¾Œç«¯çš„ JSONdataï¼š", JSONdata);

            $.ajax({
                type: "POST",
                url: "ani_member_control_api_v1.php?action=logout",
                data: JSONdata,
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    console.log("å¾Œç«¯å›æ‡‰ï¼š", response);

                    if (response.state) {
                        // æ¸…é™¤ Cookie
                        clearCookie("Uid01");

                        // âœ… æ›´æ–° UI ä¸¦è·³è½‰é¦–é 
                        setTimeout(() => {
                            updateUI(false);
                            Swal.fire({
                                title: "å·²ç™»å‡º",
                                text: "å³å°‡è¿”å›é¦–é ...",
                                icon: "success",
                                timer: 2000, // 2ç§’å¾Œè‡ªå‹•é—œé–‰
                                showConfirmButton: false
                            }).then(() => {
                                window.location.href = "/web202411/animals.html"; // ğŸ”„ è·³è½‰åˆ°é¦–é 
                            });
                        }, 500); // âœ… ç­‰å¾… Cookie ç¢ºå¯¦åˆªé™¤
                    } else {
                        Swal.fire({
                            title: "ç™»å‡ºå¤±æ•—",
                            text: response.message || "ç™»å‡ºæ™‚ç™¼ç”ŸéŒ¯èª¤",
                            icon: "error"
                        });
                    }
                },
                error: function (xhr) {
                    console.error("ç™»å‡ºè«‹æ±‚å¤±æ•—", xhr.responseText);
                    Swal.fire({
                        title: "éŒ¯èª¤",
                        text: "ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨ã€‚",
                        icon: "error"
                    });
                }
            });
        });

        // æª¢æŸ¥å¸³è™Ÿæ˜¯å¦é‡è¤‡çš„å›æ‡‰è™•ç†
        function showdata_checkuni(data) {
            console.log("æª¢æŸ¥å¸³è™Ÿé‡è¤‡å›æ‡‰:", data);

            if (data.state) {
                $("#username_reg").removeClass("is-invalid").addClass("is-valid");
                $("#regModal_username_valid_feedback").text(data.message);
            } else {
                $("#username_reg").removeClass("is-valid").addClass("is-invalid");
                $("#regModal_username_invalid_feedback").text(data.message);
            }
        }

        // SweetAlert æç¤ºæ¡†
        function showLoginAlert() {
            Swal.fire({
                title: "è«‹å…ˆç™»å…¥æœƒå“¡ï¼",
                text: "ç™»å…¥å¾Œæ‰å¯ä»¥ä½¿ç”¨é ˜é¤ŠåˆŠç™»åŠŸèƒ½ï¼",
                icon: "info",
                confirmButtonText: "ç¢ºå®š"
            });
        }

        $(document).ready(function () {
            checkLoginStatus(); // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
            loadAnimalList();   // è¼‰å…¥åˆŠç™»çš„å¯µç‰©è³‡æ–™
        });

        // âœ… è¨­å®š Cookie
        function setCookie(name, value, days) {
            let expires = "";
            if (days) {
                let date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + value + expires + "; path=/"; // âœ… è¨­å®š `path=/`
        }

        // âœ… å–å¾— Cookie
        function getCookie(name) {
            let matches = document.cookie.match(new RegExp(
                "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
            ));
            return matches ? decodeURIComponent(matches[1]) : "";
        }

        // âœ… æ¸…é™¤ Cookie
        function clearCookie(name) {
            console.log("ğŸ—‘ï¸ å˜—è©¦æ¸…é™¤ Cookieï¼š" + name);
            document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        }


        // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
        function checkLoginStatus() {
            var uid = getCookie("Uid01");
            console.log("æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼ŒUid01:", uid);

            if (uid) {
                // é€éå¾Œç«¯ç¢ºèª uid æ˜¯å¦æœ‰æ•ˆ
                $.ajax({
                    type: "POST",
                    url: "ani_member_control_api_v1.php?action=checkuid",
                    data: JSON.stringify({ uid01: uid }),
                    contentType: "application/json",
                    dataType: "json",
                    success: function (response) {
                        console.log("å¾Œç«¯å›æ‡‰:", response);
                        if (response.state) {
                            updateUI(true, response.data.Username, response.data.role);  // æ–°å¢è§’è‰²åƒæ•¸
                        } else {
                            updateUI(false);
                            showLoginAlert(); // æ²’æœ‰ç™»å…¥æˆ–å¤±æ•ˆå‰‡æç¤º
                        }
                    },
                    error: function () {
                        console.error("æª¢æŸ¥ç™»å…¥ç‹€æ…‹å¤±æ•—");
                        updateUI(false);
                        showLoginAlert(); // å¦‚æœå¾Œç«¯æ²’å›æ‡‰ä¹Ÿæç¤º
                    }
                });
            } else {
                updateUI(false);
                showLoginAlert(); // æ²’æœ‰ Uid01 æ™‚ç›´æ¥æç¤º
            }
        }

        // æ›´æ–° UI        
        function updateUI(isLoggedIn, username = "", role = "") {
            if (isLoggedIn) {
                $("#s02_reg_btn, #s02_login_btn").addClass("d-none");
                $("#s02_logout_btn, #s02_username_showtext").removeClass("d-none");
                $("#s02_username_text").text(username);

                if (role === "admin") {
                    $("#admin_control_nav, #public_adoption_nav").removeClass("d-none");  // é¡¯ç¤ºå¾Œå°æ§åˆ¶èˆ‡é ˜é¤ŠåˆŠç™»ç®¡ç†é¸å–®
                } else {
                    $("#admin_control_nav").addClass("d-none");
                    $("#public_adoption_nav").removeClass("d-none");  // ä½¿ç”¨è€…ç™»å…¥å¾Œé¡¯ç¤ºé ˜é¤ŠåˆŠç™»ç®¡ç†
                }
            } else {
                $("#s02_reg_btn, #s02_login_btn").removeClass("d-none");
                $("#s02_logout_btn, #s02_username_showtext").addClass("d-none");
                $("#admin_control_nav, #public_adoption_nav").addClass("d-none");  // ç™»å‡ºæ™‚éš±è—é¸å–®
                $("#s02_username_text").text("");
            }
        }

        // âœ… è¼‰å…¥å‹•ç‰©è³‡æ–™
        function loadAnimalList() {
            const Uid01 = getCookie("Uid01");
            console.log("ğŸš€ ç™¼é€è«‹æ±‚ï¼ŒUid01:", Uid01);

            if (!Uid01) {
                Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•å–å¾—ä½¿ç”¨è€… IDï¼Œè«‹é‡æ–°ç™»å…¥ï¼", "error");
                return;
            }

            $.ajax({
                type: "POST",
                url: "adopt_manage_api.php?action=list",
                data: JSON.stringify({ Uid01 }),
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    console.log("âœ… å¾Œç«¯å›å‚³çš„å‹•ç‰©è³‡æ–™ï¼š", response);

                    if (!response || typeof response !== "object") {
                        Swal.fire("éŒ¯èª¤ï¼", "å¾Œç«¯å›æ‡‰æ ¼å¼éŒ¯èª¤", "error");
                        return;
                    }

                    if (!response.state) {
                        Swal.fire("éŒ¯èª¤ï¼", response.message || "ç„¡æ³•å–å¾—å‹•ç‰©è³‡æ–™(loadAnimalList)ã€‚", "error");
                        return;
                    }

                    if (!Array.isArray(response.data)) {
                        Swal.fire("éŒ¯èª¤ï¼", "å¾Œç«¯è³‡æ–™æ ¼å¼éŒ¯èª¤", "error");
                        return;
                    }

                    renderAnimalList(response.data);
                },
                error: function () {
                    Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•è¼‰å…¥å‹•ç‰©è³‡æ–™ã€‚", "error");
                }
            });
        }

        // âœ… æ¸²æŸ“å‹•ç‰©åˆ—è¡¨
        function renderAnimalList(animalList) {
            let adoptList = document.getElementById("adoptList");
            adoptList.innerHTML = ""; // æ¸…ç©ºåˆ—è¡¨

            if (!animalList || animalList.length === 0) {
                adoptList.innerHTML = "<tr><td colspan='8' class='text-center'>ç›®å‰æ²’æœ‰åˆŠç™»çš„å¯µç‰©</td></tr>";
                return;
            }

            animalList.forEach(animal => {
                let row = document.createElement("tr");
                row.innerHTML = `
            <td>${animal.pet_name}</td>
            <td>${animal.species}</td>
            <td>${animal.age ?? 'æœªå¡«å¯«'}</td>
            <td>${animal.gender}</td>
            <td>${animal.location ?? 'æœªå¡«å¯«'}</td>
            <td>${animal.description ?? 'ç„¡'}</td>
            <td><img src="${animal.image_url || '/imgs/ani19.jpg'}" alt="å‹•ç‰©åœ–ç‰‡" style="max-width: 100px;"></td>
            <td>
                <button class="btn btn-warning btn-sm" onclick="editAnimal(${animal.id})">ä¿®æ”¹</button>
                <button class="btn btn-danger btn-sm" onclick="deleteAnimal(${animal.id})">åˆªé™¤</button></td>
        `;
                adoptList.appendChild(row);
            });
        }

        // ğŸ“ å–å¾—è¦ç·¨è¼¯çš„å¯µç‰©è³‡æ–™ï¼Œä¸¦æ‰“é–‹ Modal
        function editAnimal(id) {
            console.log("ğŸ“ é€å‡ºè«‹æ±‚ï¼Œç²å–å‹•ç‰© ID:", id);  // âœ… æª¢æŸ¥ ID æ˜¯å¦æ­£å¸¸
            $.ajax({
                type: "POST",
                url: "adopt_manage_api.php?action=get",
                data: JSON.stringify({ id: id }),
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    console.log("ğŸ“Œ å¾Œç«¯å›æ‡‰ï¼š", response); // âœ… æª¢æŸ¥å¾Œç«¯å›å‚³è³‡æ–™
                    if (response.state) {
                        let animal = response.data;
                        $("#editAnimalId").val(animal.id);
                        $("#edit_pet_name").val(animal.pet_name);
                        $("#edit_species").val(animal.species);
                        $("#edit_age").val(animal.age);
                        $("#edit_gender").val(animal.gender);
                        $("#edit_location").val(animal.location);
                        $("#edit_description").val(animal.description);
                        $("#editAnimalModal").modal("show");
                    } else {
                        Swal.fire("éŒ¯èª¤ï¼", response.message, "error");
                    }
                },
                error: function (xhr) {
                    console.error("âŒ AJAX éŒ¯èª¤ï¼š", xhr.responseText);
                    Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•å–å¾—å‹•ç‰©è³‡æ–™", "error");
                }
            });
        }


        // âœ… æäº¤ä¿®æ”¹
        $("#editAnimalForm").on("submit", function (e) {
            e.preventDefault();

            let updatedData = {
                id: $("#editAnimalId").val(),
                pet_name: $("#edit_pet_name").val(),
                species: $("#edit_species").val(),
                age: $("#edit_age").val(),
                gender: $("#edit_gender").val(),
                location: $("#edit_location").val(),
                description: $("#edit_description").val()
            };

            $.ajax({
                type: "POST",
                url: "adopt_manage_api.php?action=update",
                data: JSON.stringify(updatedData),
                contentType: "application/json",
                dataType: "json",
                success: function (response) {
                    if (response.state) {
                        Swal.fire("æˆåŠŸï¼", "å‹•ç‰©è³‡æ–™å·²æ›´æ–°", "success").then(() => {
                            $("#editAnimalModal").modal("hide");
                            loadAnimalList(); // é‡æ–°è¼‰å…¥è¡¨æ ¼
                        });
                    } else {
                        Swal.fire("éŒ¯èª¤ï¼", response.message, "error");
                    }
                },
                error: function () {
                    Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•æ›´æ–°å‹•ç‰©è³‡æ–™", "error");
                }
            });
        });


        // âœ… åˆªé™¤å‹•ç‰©è³‡æ–™
        function deleteAnimal(id) {
            if (!id || isNaN(id)) {
                Swal.fire("éŒ¯èª¤ï¼", "åˆªé™¤æ™‚ç¼ºå°‘æœ‰æ•ˆçš„ IDã€‚", "error");
                return;
            }

            Swal.fire({
                title: "ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ",
                text: "æ­¤æ“ä½œç„¡æ³•å¾©åŸï¼",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#d33",
                cancelButtonColor: "#3085d6",
                confirmButtonText: "ç¢ºå®šåˆªé™¤"
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: "POST",
                        url: "adopt_manage_api.php?action=delete",
                        data: JSON.stringify({ id: id }),
                        contentType: "application/json",
                        dataType: "json",
                        success: function (response) {
                            if (response.state) {
                                Swal.fire("å·²åˆªé™¤ï¼", "è³‡æ–™å·²æˆåŠŸåˆªé™¤ã€‚", "success");
                                loadAnimalList(); // é‡æ–°è¼‰å…¥å‹•ç‰©è³‡æ–™
                            } else {
                                Swal.fire("éŒ¯èª¤ï¼", response.message, "error");
                            }
                        },
                        error: function () {
                            Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•åˆªé™¤è³‡æ–™ã€‚", "error");
                        }
                    });
                }
            });
        }

        //åœ–ç‰‡é è¦½
        document.getElementById("animal_image").addEventListener("change", function (event) {
            const file = event.target.files[0]; // å–å¾—ä½¿ç”¨è€…é¸æ“‡çš„æª”æ¡ˆ
            if (file) {
                const reader = new FileReader(); // å»ºç«‹ FileReader ç‰©ä»¶
                reader.onload = function (e) {
                    document.getElementById("previewImage").src = e.target.result; // è¨­å®šé è¦½åœ–ç‰‡çš„ src
                };
                reader.readAsDataURL(file); // è®€å–åœ–ç‰‡ä¸¦è½‰æ›æˆ Data URL
            }
        });

        $(document).ready(function () {
            $("#adoptForm").on("submit", function (e) {
                e.preventDefault();
                let formData = new FormData(this);

                // âœ… å¾ Cookie å–å¾— Uid01
                const Uid01 = getCookie("Uid01");
                console.log("ğŸš€ å‰ç«¯æŠ“åˆ°çš„ Uid01ï¼š", Uid01);

                if (!Uid01) {
                    Swal.fire("éŒ¯èª¤ï¼", "è«‹å…ˆç™»å…¥æ‰èƒ½åˆŠç™»å‹•ç‰©è³‡æ–™ï¼", "error");
                    return; // æ²’æœ‰ç™»å…¥å‰‡é˜»æ­¢æäº¤
                }

                formData.append('Uid01', Uid01); // âœ… å‚³é Uid01 çµ¦å¾Œç«¯

                // âœ… æª¢æŸ¥é€å‡ºçš„è³‡æ–™
                for (let [key, value] of formData.entries()) {
                    console.log(`${key}: ${value}`);
                }

                $.ajax({
                    type: "POST",
                    url: "adopt_manage_api.php?action=add",
                    data: formData,
                    contentType: false,
                    processData: false,
                    dataType: "json",
                    success: function (response) {
                        console.log("âœ… å¾Œç«¯å›æ‡‰ï¼š", response);
                        if (response.state) {
                            Swal.fire("æˆåŠŸï¼", "å‹•ç‰©è³‡æ–™å·²æ–°å¢ï¼", "success").then(() => {
                                loadAnimalList(); // é‡æ–°è¼‰å…¥å·²åˆŠç™»çš„å¯µç‰©
                                $("#adoptForm")[0].reset();
                            });
                        } else {
                            Swal.fire("éŒ¯èª¤ï¼", response.message, "error");
                        }
                    },
                    error: function (xhr) {
                        console.error("âŒ AJAX éŒ¯èª¤ï¼š", xhr.responseText);
                        Swal.fire("éŒ¯èª¤ï¼", "ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨ã€‚", "error");
                    }
                });
            });
        });





    </script>

</body>

</html>